<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="favicon.ico">
    <title>Explore Byte Tutorial</title>
    
    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- Custom styles for this project -->
    <link href="css/explore.css" rel="stylesheet">
  </head>
  
  <body role="document">
    
    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container" >
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="about">About This Data Set</a></li>
	    <li><a href="quality">Data Quality</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
    
    <div class="container theme-showcase" role="main">

      <!-- Main jumbotron for a primary marketing message or call to action -->
      <div class="jumbotron">
	<h1>Interactive Data Science Project Exploratory Analysis Byte Example</h1>
        <p>This is the Exploratory Analysis Byte of the Interactive Data Science class.</p>
      </div>
      
      <div class="page-header">
	
      </div> <!-- /page-header -->
    </div> <!-- /container -->
    <div style="text-align:center; width:90%; margin:0 auto">
            <h2> Showcase of Raw Dataset</h2>
  <p>(in 1 row and airline_name = "united-airlines", because the content is too long)</p>
    <div class="button-toolbar" role="toolbar" id="headers" name="headers">
      {% for column in columns %}
      <button type="button" class = "btn-space btn btn-info" id="{{column}}" onclick="updateTable('{{column}}')">{{column}}</button>
      {% endfor %}
    </div>
    
    <!--
    <div id="animals"><table id="data" class="table table-striped table-hover">
	<thead class ="thead-inverse">
	  <tr id="cols">
	  </tr>
	</thead>
	<tbody id="rows"> 
	</tbody>
    </table></div>
  -->

  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead class="thead-inverse">
       <tr id="cols">
    {% for item in columns %}
             <th>{{ item }}</th>
    {% endfor %}
         </tr>
        </thead>
        <tbody id="rows">
    {% for row in rows %}
         <tr>
      {% for datum in row %}
                <td>{{ datum }} </td>
      {% endfor %}
         </tr>
    {% endfor %}
        </tbody>
     </table>
  </div>
  <div style="height:10em"></div>
  <div>
  <h2>Interactive Showcase of Questions and Answers Based on Cleaned Data</h2>
  <div style="height:1em"></div>
  <h3>Qestion 1: Passengers in which cabin(s) feel most satisfied in general?</h3>
  <iframe width="1000" height="800" scrolling="no" frameborder="no" src="https://fusiontables.google.com/embedviz?containerId=googft-gviz-canvas&amp;q=select+col5%2C+AVERAGE(col6)%2C+AVERAGE(col7)%2C+AVERAGE(col8)%2C+AVERAGE(col13)%2C+AVERAGE(col14)+from+18MyHVh8LRiSZSxJtHEzsCW6sCI4y0XkCSxsr9usr+where+col5+in+(&#39;Business+Class&#39;%2C+&#39;Economy&#39;%2C+&#39;First+Class&#39;%2C+&#39;Premium+Economy&#39;)+group+by+col5+order+by+AVERAGE(col6)+asc+limit+10&amp;viz=GVIZ&amp;t=COLUMN&amp;uiversion=2&amp;gco_forceIFrame=true&amp;gco_hasLabelsColumn=true&amp;gco_vAxes=%5B%7B%22title%22%3Anull%2C+%22minValue%22%3Anull%2C+%22maxValue%22%3Anull%2C+%22useFormatFromData%22%3Atrue%2C+%22viewWindow%22%3A%7B%22max%22%3Anull%2C+%22min%22%3Anull%7D%2C+%22logScale%22%3Afalse%7D%2C%7B%22useFormatFromData%22%3Atrue%2C+%22viewWindow%22%3A%7B%22max%22%3Anull%2C+%22min%22%3Anull%7D%2C+%22minValue%22%3Anull%2C+%22maxValue%22%3Anull%2C+%22logScale%22%3Afalse%7D%5D&amp;gco_useFirstColumnAsDomain=true&amp;gco_legacyScatterChartLabels=true&amp;gco_isStacked=false&amp;gco_booleanRole=certainty&amp;gco_hAxis=%7B%22useFormatFromData%22%3Atrue%2C+%22minValue%22%3Anull%2C+%22maxValue%22%3Anull%2C+%22viewWindow%22%3Anull%2C+%22viewWindowMode%22%3Anull%2C+%22slantedText%22%3Afalse%7D&amp;gco_legend=right&amp;gco_legendTextStyle=%7B%22color%22%3A%22%23222%22%2C+%22fontSize%22%3A%2212%22%7D&amp;gco_backgroundColor=%7B%22fill%22%3A%22%23f3f3f3%22%7D&amp;gco_domainAxis=%7B%22direction%22%3A1%7D&amp;gco_title=Satisfaction+Rating+in+Different+Cabin+Levels&amp;gco_titleTextStyle=%7B%22color%22%3A%22%23000%22%2C+%22fontSize%22%3A%2216%22%2C+%22bold%22%3Atrue%7D&amp;width=1000&amp;height=800"></iframe>
  <p>Answer: As shown above, passengers in the higher class are more satisfied with the flight journey. This is reasonable, because higher class (first class, business class) can provide a better environment, more devoted flight attendants service, for a better air trip experience. Interestingly, the average "value_money_rating" given by the passengers in a higher class is also higher. I think the reason should be, as the customer level go up, they become less insensitive to price increases, more sensitive to the promotion of services. So, even if they pay a lot money, still feel more worthful for better environment and services.
</p> <p>And, more interestingly. Compared with the economy class, Premium Economy passengerâ€™s satisfaction is lower. Similarly, First Class passengers are less satisfied than Business Class passengers. In my opinion, this may be because there is not a correspondingly distinctly differentiated product and service provided between these cabin classes. This leads to passengers have had the high expectations, but have not been satisfied, and results in a decline in satisfaction.
</p>
  <div style="height:1em"></div>
  <h3>Qestion 2: Passengers in which country(s) are most likely to fly in Business or First class cabin?</h3>
 <iframe width="1000" height="800" scrolling="no" frameborder="no" src="https://fusiontables.google.com/embedviz?containerId=googft-gviz-canvas&amp;q=select+col1%2C+count()+from+18MyHVh8LRiSZSxJtHEzsCW6sCI4y0XkCSxsr9usr+where+col5+in+(&#39;Business+Class&#39;%2C+&#39;First+Class&#39;)+group+by+col1+order+by+count()+desc+limit+20&amp;viz=GVIZ&amp;t=COLUMN&amp;uiversion=2&amp;gco_forceIFrame=true&amp;gco_hasLabelsColumn=true&amp;gco_vAxes=%5B%7B%22title%22%3A%22Number+of+reviews+made+by+a+business+or+first+class+passenger%22%2C+%22minValue%22%3Anull%2C+%22maxValue%22%3Anull%2C+%22useFormatFromData%22%3Atrue%2C+%22viewWindow%22%3A%7B%22max%22%3Anull%2C+%22min%22%3Anull%7D%7D%2C%7B%22useFormatFromData%22%3Atrue%2C+%22viewWindow%22%3A%7B%22max%22%3Anull%2C+%22min%22%3Anull%7D%2C+%22minValue%22%3Anull%2C+%22maxValue%22%3Anull%7D%5D&amp;gco_useFirstColumnAsDomain=true&amp;gco_legacyScatterChartLabels=true&amp;gco_isStacked=false&amp;gco_booleanRole=certainty&amp;gco_hAxis=%7B%22useFormatFromData%22%3Atrue%2C+%22minValue%22%3Anull%2C+%22maxValue%22%3Anull%2C+%22viewWindow%22%3Anull%2C+%22viewWindowMode%22%3Anull%7D&amp;gco_legend=none&amp;gco_title=&amp;gco_backgroundColor=%7B%22fill%22%3A%22%23f3f3f3%22%7D&amp;width=1000&amp;height=800"></iframe>
 <p>Answer: We can see that the top few places are developed countries, especially the United States and United Kingdom. This is reasonable as the developed countries occupy a much major part of the global economy. Moreover, companies in developed countries are more likely to be the global leaders in industries, which means more business travel.
Interestingly, Australia is in significantly ahead position compared to its position in the world economy. In my opinion, this may be related to its unique geographical environment. Because Australia is located in the Pacific Ocean, the aircraft is the main bridge connecting itself and the world, so it makes sense that it contributes more high-level (business) travel.
</p>
	<div style="height:1em"></div>

  </div>
  </div>
  
  
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script>
	function updateTable(str) {
		console.log("in updateTable");
		console.log(str);

	    // error checking: ignore buttons that don't have a title!
		if (str == "") {
			return;
		}

	    // find the actual button in this document's HTML
		button = document.getElementById(str);
		// for debugging, write its name to the console
		console.log(button.className);
		// check if it is disabled (btn-info)
		if (button.className.includes("btn-info")) {
			// and enable it (btn-primary)
			button.className = "btn btn-space btn-primary";
		} else {
			// otherwise disable it (btn-info)
			button.className = "btn btn-space btn-info";
		}

		// now get all the buttons
		buttons = document.getElementById("headers").children;
		// and collect their names in cols
		cols = [];
		// loop through them
		for (button in buttons) {
			// grab the id (the name we need is there)
			id = buttons[button].id;
			// make sure it isn't null
			if (buttons[button].id != null) {
				// and that the button is selected 
				var isPrimary = buttons[button].className.includes("btn-primary");
				if (isPrimary && (cols.indexOf(id) == -1)) {
					// if so, add it to our array
					cols.push(id);
				}
			}
		}
					
		$.ajax({
			url: '/_update_table',
			dataType: 'json',
			contentType: 'application/json',
			data: JSON.stringify({'cols' : cols}),
			type: 'POST',
			success: function (res, status) {
				console.log("successrunning");
				console.log(res["content"]);
				console.log(res["headers"]);
				var cols = res["headers"];
				var rows = res["content"];

				// get the table, columns and rows
				table = document.getElementById("data");
				headers = document.getElementById("cols");
				body = document.getElementById("rows");

				// delete current contents
				headers.innerHTML='';
				body.innerHTML = '';

				// and put the new information in the table
				for (col in cols) {
					cell = document.createElement("th");
					cell.innerHTML = cols[col];
					headers.appendChild(cell);
				}
				for (row in rows) {
					tr = document.createElement("tr");
					for (item in rows[row]) {
						td = document.createElement("td");
						td.innerHTML = rows[row][item];
						tr.appendChild(td);
					}
					body.appendChild(tr);
				}
			},
			error: function(res, status) {
				// On Error
				alert('error');
			}
		});
	}
				
				   
				   
</script>
</body>
</html>
